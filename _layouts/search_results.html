<!DOCTYPE html>
<html lang="en">

<head>
    <title>Cloud 66 Documentation | Search Reults</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-25691976-6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-25691976-6');
    </script>

    <meta charset="utf-8">
    <meta name="description" content="Cloud 66 - Documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Cloud 66 Documentation">
    <meta property="og:description" content="Guides, Tutorials and Documentation for Cloud 66 Products">
    <meta property="og:image" content="/images/ui/logo.svg">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Cloud 66 Documentation">
    <meta name="twitter:description" content="Guides, Tutorials and Documentation for Cloud 66 Products">
    <meta name="twitter:image" content="/images/ui/logo.svg">

    <link rel="icon" href="/images/ui/favicon.ico" type="image/png">
    {% include styles.html %}
    <link rel="stylesheet" href="/css/searchResults.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script> -->
    <script type='text/javascript' src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://twitter.github.com/hogan.js/builds/2.0.0/hogan-2.0.0.js"></script>
    <script type='text/javascript' src='js/jquery.swiftype.search.js'></script>
    <script type='text/javascript' src='js/jquery.ba-hashchange.min.js'></script>
    <script type="text/javascript" src="js/swiftype_search.js"></script>

</head>

<body class="Body Body--home">


{% include top_nav_bar.html %}

<main id="main">
    <!-- Search bar. -->
    <section class="LandingContainer">
        <form id="search-form" method="get">
            <input type="text"
                   id="search-query-home"
                   name="q"
                   class="search search--lrg u-fullWidth"
                   placeholder="Search all product Documentation">
        </form>
    </section>

    <!-- Container for the search results, filled in with JavaScript -->
    <div id="hits" class="Landing">
        <section class="LandingContainer" id="js_search_results_container">
            <p id="js_search_title">You searched for <strong class="SearchResults-title" id="js_search_term"></strong></p>
            <div id="js_search_results_list">
                <ul class="SearchResults" id="js_search_results_list">
                    <li>
                        <p>
                            <span class="is-loading"></span> Getting Search Results&hellip;
                        </p>
                    </li>
                </ul>
            </div>
            <div id="js_search_results_paging">
            </div>
        </section>
    </div>

</main>

{% include footer.html %}
<script type="text/javascript">
{% raw %}
var resultTemplate = Hogan.compile(
    '<div class="SearchResults-item">' +
        '<a href="{{url}}" class="SearchResults-link">' +
            '<h3 class="SearchResults-subTitle">{{title}}</h3>' +
            '{{#description}}<p class="SearchResults-text">{{description}}</p>{{/description}}{{^description}}<p class="SearchResults-text">Answered on the Cloud 66 community forum</p>{{/description}}' +
            '{{#product}}<div class="SearchResults-ico SearchResults-ico--{{product}}"></div>{{/product}} {{^product}} <div class="SearchResults-ico SearchResults-ico--community"></div> {{/product}}' +
            '{{#product}}<div class="Tag Tag--lrg">{{product}}</div>{{/product}} {{^product}} <div class="Tag Tag--lrg">Community</div> {{/product}}'+
        '</a>' +
    '</div>'
                                );
{% endraw %}

var searchResultRenderFunction = function(documentType, item) {
    var data = {
        url: item['url'],
        title: item['title'],
        description: item['description'],
        product: item['product'],
    };
    var q =
    console.log(q);

    return resultTemplate.render(data);
};

var getQuery = function() {
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('q');
    return query;
}

var selectedProduct = function() {
    var value = $("input[name=document_type]:radio:checked").val();
    if (value === 'all') {
        return [];
    } else {
        return [value];
    }
};

$(function() {

    $('#search-query-home').swiftypeSearch({
        resultContainingElement: '#js_search_results_list',
        engineKey: 'bN_9bsG93qxs_9H4Jc27',
        renderFunction: searchResultRenderFunction,
        filters: {'product': 'Rails'},
        documentTypes: selectedProduct
    });


    const query = getQuery();
    if ( query ) {
        $('#search-query-home').val(query);
        $('#search-form').submit();
        $('#js_search_term').html( query );
    }
});
</script>
</body>

</html>
